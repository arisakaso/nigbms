settings:
  agents_per_gpu: 2
  sweep_path: null

sweep:
  project: poisson1d_small
  program: /workspaces/nigbms/examples/poisson1d/train.py
  name: ${now:%Y-%m-%d_%H-%M-%S}
  method: grid
  parameters:
    wrapper.hparams.opt.lr:
      values:
        - 1.0e-2
        - 1.0e-3
        - 1.0e-4
        - 1.0e-5
    wrapper.hparams.opt.momentum:
      values:
        - 0
        - 0.9
    # latent_dim:
    #   values:
    #     - 32
    #     - 16
    #     - 8
    #     - 4
    # surrogate.model.output_activation:
    #   values:
    #   - _target_: torch.nn.Identity
    #   - _target_: torch.nn.ReLU
    #   - _target_: nigbms.modules.models.InverseBoxCox
    #     lmbda: 0
    #   - _target_: nigbms.modules.models.InverseBoxCox
    #     lmbda: 1.0e-3
    #   - _target_: nigbms.modules.models.InverseBoxCox
    #     lmbda: 1.0e-1    
    # surrogate.model.hidden_activation:
    #   values:
    #   - _target_: torch.nn.SiLU
    #   - _target_: torch.nn.GELU
    # surrogate.model.init_scale:
    #   values:
    #   - 1.0e+2
    #   - 1.0e+1
    #   - 1.0e+0 # looks best
    #   - 1.0e-1
    #   - 1.0e-2
    # surrogate.model.n_conv_layers:
    #   values:
    #   - 1
    #   - 2
    #   - 3
    #   - 4
    # surrogate.model.n_fcn_layers:
    #   values:
    #   - 1
    #   - 2
    #   - 3
    #   - 4
    # surrogate.model.base_channels:
    #   values:
    #   - 32
    #   - 64
    #   - 128
    #   - 256
    #   - 512
    # surrogate.model.kernel_size:
    #   values:
    #   - 3
    #   - 5
    #   - 7
    #   - 9
    #   - 11
    # surrogate.model.n_components:
    #   values:
    #   - 31
    #   - 64
    #   - 128
    #   - 256
    # wrapper.hparams.loss.weights:
    #   values:
    #     - dvL_loss: 1
    #     - dvf_loss: 1
    #     - dvf_loss_relative: 1
    #     - y_loss: 1
    #     - y_loss_relative: 1
    # wrapper.hparams.opt.lr:
    #   values:
    #     - 1.0e-2        
    #     - 1.0e-3
    #     - 1.0e-4
    #     - 1.0e-5